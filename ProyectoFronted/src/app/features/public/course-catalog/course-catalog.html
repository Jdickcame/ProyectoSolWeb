<app-navbar></app-navbar>

    <!-- Header -->
    <section class="catalog-header bg-dark-theme text-white py-5">
      <div class="container">
        <h1 class="display-4 fw-bold mb-3">Explorar Cursos</h1>
        <p class="lead text-white">Encuentra el curso perfecto para ti</p>
      </div>
    </section>

    <!-- Filters and Results -->
    <section class="py-5 bg-light">
      <div class="container">
        <div class="row">
          <!-- Sidebar Filters -->
          <div class="col-lg-3 mb-4">
            <div class="card-modern p-4 sticky-top top-spacing">
              <h5 class="fw-bold mb-4">
                <i class="bi bi-funnel me-2"></i>Filtros
              </h5>

              <!-- Search -->
              <div class="mb-4">
                <label class="form-label fw-semibold small">Buscar</label>
                <input 
                  type="text"
                  class="form-control"
                  placeholder="Buscar cursos..."
                  [(ngModel)]="searchQuery"
                  (ngModelChange)="onSearchChange()">
              </div>

              <!-- Category -->
              <div class="mb-4">
                <label class="form-label fw-semibold small">Categoría</label>
                <select 
                  class="form-select"
                  [(ngModel)]="selectedCategory"
                  (ngModelChange)="applyFilters()"
                  aria-label="Filtrar por categoría">
                  <option [value]="null">Todas las categorías</option>
                  @for (cat of categories; track cat.value) {
                    <option [value]="cat.value">{{ cat.label }}</option>
                  }
                </select>
              </div>

              <!-- Level -->
              <div class="mb-4">
                <label class="form-label fw-semibold small">Nivel</label>
                <select 
                  class="form-select"
                  [(ngModel)]="selectedLevel"
                  (ngModelChange)="applyFilters()"
                  aria-label="Filtrar por niveles">
                  <option [value]="null">Todos los niveles</option>
                  @for (level of levels; track level.value) {
                    <option [value]="level.value">{{ level.label }}</option>
                  }
                </select>
              </div>

              <!-- Price Range -->
              <div class="mb-4">
                <label class="form-label fw-semibold small">Precio</label>
                <div class="form-check mb-2">
                  <input 
                    class="form-check-input" 
                    type="checkbox" 
                    id="freeCourses"
                    [(ngModel)]="onlyFree"
                    (ngModelChange)="applyFilters()">
                  <label class="form-check-label small" for="freeCourses">
                    Solo cursos gratis
                  </label>
                </div>
                <div class="form-check">
                  <input 
                    class="form-check-input" 
                    type="checkbox" 
                    id="liveClasses"
                    [(ngModel)]="hasLiveClasses"
                    (ngModelChange)="applyFilters()">
                  <label class="form-check-label small" for="liveClasses">
                    Con clases en vivo
                  </label>
                </div>
              </div>

              <!-- Clear Filters -->
              <button 
                class="btn btn-outline-secondary w-100 btn-sm"
                (click)="clearFilters()">
                <i class="bi bi-x-circle me-2"></i>Limpiar Filtros
              </button>
            </div>
          </div>

          <!-- Results -->
          <div class="col-lg-9">
            <!-- Sort and Count -->
            <div class="d-flex justify-content-between align-items-center mb-4">
              <div>
                <h5 class="mb-0">
                  <strong>{{ courses().length }}</strong> cursos encontrados
                </h5>
              </div>
              <div class="d-flex gap-2 align-items-center">
                <label class="small text-muted mb-0">Ordenar por:</label>
                <select 
                  class="form-select form-select-sm"
                  [(ngModel)]="sortBy"
                  (ngModelChange)="applyFilters()"
                  aria-label="Ordenar por">
                  @for (sort of sortOptions; track sort.value) {
                    <option [value]="sort.value">{{ sort.label }}</option>
                  }
                </select>
              </div>
            </div>

            <!-- Loading -->
            @if (isLoading()) {
              <div class="text-center py-5">
                <app-loading-spinner [size]="60" message="Cargando cursos..."></app-loading-spinner>
              </div>
            }

            <!-- Courses Grid -->
            @else if (courses().length > 0) {
              <div class="row g-4">
                @for (course of courses(); track course.id) {
                  <div class="col-md-6 col-xl-4">
                    <app-course-card [course]="course"></app-course-card>
                  </div>
                }
              </div>

              <!-- Pagination -->
              @if (totalPages() > 1) {
                <nav class="mt-5">
                  <ul class="pagination justify-content-center">
                    <li class="page-item" [class.disabled]="currentPage() === 1">
                      <a class="page-link" (click)="goToPage(currentPage() - 1)">
                        <i class="bi bi-chevron-left"></i>
                      </a>
                    </li>
                    
                    @for (page of getPageNumbers(); track page) {
                      <li class="page-item" [class.active]="page === currentPage()">
                        <a class="page-link" (click)="goToPage(page)">{{ page }}</a>
                      </li>
                    }
                    
                    <li class="page-item" [class.disabled]="currentPage() === totalPages()">
                      <a class="page-link" (click)="goToPage(currentPage() + 1)">
                        <i class="bi bi-chevron-right"></i>
                      </a>
                    </li>
                  </ul>
                </nav>
              }
            }

            <!-- Empty State -->
            @else {
              <div class="text-center py-5">
                <i class="bi bi-inbox display-1 text-muted"></i>
                <h4 class="mt-4 text-muted">No se encontraron cursos</h4>
                <p class="text-muted">Intenta ajustar los filtros de búsqueda</p>
                <button class="btn btn-gradient mt-3" (click)="clearFilters()">
                  Limpiar Filtros
                </button>
              </div>
            }
          </div>
        </div>
      </div>
    </section>

    <app-footer></app-footer>